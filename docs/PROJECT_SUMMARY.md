# Message Board System - é¡¹ç›®å®Œæˆæ€»ç»“

## ğŸ“¦ é¡¹ç›®æ¦‚è¿°

ä¸º AI CLI è®¾è®¡çš„è·¨ç»ˆç«¯å¼‚æ­¥é€šä¿¡ç•™è¨€ç°¿ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§ AI CLIï¼ˆClaude Codeã€Aiderã€iFlow CLI ç­‰ï¼‰çš„ Hooks é›†æˆï¼Œå®ç°è‡ªåŠ¨æ£€æµ‹å’Œå›å¤æ¶ˆæ¯ã€‚

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AI CLI ç”Ÿæ€                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ Claude Code â”‚  â”‚   Aider     â”‚  â”‚  iFlow CLI  â”‚             â”‚
â”‚  â”‚   Hooks     â”‚  â”‚   Hooks     â”‚  â”‚ Notificationâ”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â”‚                â”‚                â”‚                     â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                          â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç•™è¨€ç°¿ç³»ç»Ÿ                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CLI å·¥å…·                                                 â”‚   â”‚
â”‚  â”‚  - send / read / mark-read / status                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  MCP Server                                               â”‚   â”‚
â”‚  â”‚  - Tools: send_message, read_messages, ...               â”‚   â”‚
â”‚  â”‚  - Resources: messages://unread, status://current        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Watch Daemon                                             â”‚   â”‚
â”‚  â”‚  - æ–‡ä»¶ç›‘å¬ (watchdog)                                    â”‚   â”‚
â”‚  â”‚  - æ¶ˆæ¯å¤„ç† (è¿‡æ»¤/å»é‡)                                   â”‚   â”‚
â”‚  â”‚  - AI è§¦å‘å™¨ (tmux/hook/command)                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  SQLite Database (WAL Mode)                               â”‚   â”‚
â”‚  â”‚  - messages è¡¨                                            â”‚   â”‚
â”‚  â”‚  - clients è¡¨                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
message-board-system/
â”œâ”€â”€ README.md                       # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ EXAMPLES.md                     # ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ IFLOW_INTEGRATION.md            # iFlow CLI é›†æˆæŒ‡å—
â”œâ”€â”€ design.md                       # è®¾è®¡æ–‡æ¡£
â”œâ”€â”€ start.sh                        # å¿«é€Ÿå¯åŠ¨è„šæœ¬
â”œâ”€â”€ requirements.txt                # Python ä¾èµ–
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ database.py                 # SQLite æ•°æ®åº“å±‚
â”‚   â”œâ”€â”€ models.py                   # æ•°æ®æ¨¡å‹
â”‚   â”‚
â”‚   â”œâ”€â”€ cli/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ main.py                 # CLI å…¥å£
â”‚   â”‚   â””â”€â”€ commands.py             # CLI å‘½ä»¤
â”‚   â”‚
â”‚   â”œâ”€â”€ mcp_server/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ server.py               # MCP Server
â”‚   â”‚   â”œâ”€â”€ tools.py                # MCP Tools
â”‚   â”‚   â””â”€â”€ resources.py            # MCP Resources
â”‚   â”‚
â”‚   â””â”€â”€ daemon/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ main.py                 # Watch Daemon å…¥å£
â”‚       â”œâ”€â”€ watcher.py              # æ–‡ä»¶ç›‘å¬
â”‚       â”œâ”€â”€ processor.py            # æ¶ˆæ¯å¤„ç†
â”‚       â””â”€â”€ trigger.py              # AI è§¦å‘å™¨
â”‚
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ claude-code/
â”‚   â”‚   â””â”€â”€ check-messages.sh       # Claude Code Hook
â”‚   â”œâ”€â”€ aider/
â”‚   â”‚   â””â”€â”€ check-messages.sh       # Aider Hook
â”‚   â””â”€â”€ iflow_trigger.py            # iFlow CLI è§¦å‘å™¨
â”‚
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ config.yaml.example         # é€šç”¨é…ç½®ç¤ºä¾‹
â”‚   â”œâ”€â”€ hooks/check-messages.toml   # Hook é…ç½®æ¨¡æ¿
â”‚   â””â”€â”€ iflow-settings.json         # iFlow CLI é…ç½®ç¤ºä¾‹
â”‚
â””â”€â”€ tests/
    â””â”€â”€ test_e2e.py                 # ç«¯åˆ°ç«¯æµ‹è¯•
```

---

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. æ ¸å¿ƒåŠŸèƒ½
- [x] SQLite æ•°æ®åº“å±‚ï¼ˆWAL æ¨¡å¼ï¼Œæ”¯æŒå¹¶å‘è¯»å†™ï¼‰
- [x] æ•°æ®æ¨¡å‹ï¼ˆMessage, Clientï¼‰
- [x] CLI å·¥å…·ï¼ˆsend, read, mark-read, status, list, delete, clearï¼‰
- [x] MCP Serverï¼ˆTools + Resourcesï¼‰
- [x] Watch Daemonï¼ˆæ–‡ä»¶ç›‘å¬ + è‡ªåŠ¨è§¦å‘ï¼‰

### 2. Hooks é›†æˆ
- [x] Claude Code Hook è„šæœ¬
- [x] Aider Hook è„šæœ¬
- [x] iFlow CLI Notification Hook è§¦å‘å™¨

### 3. è§¦å‘å™¨
- [x] tmux è§¦å‘ï¼ˆsend-keys æ³¨å…¥å‘½ä»¤ï¼‰
- [x] Hook è„šæœ¬è§¦å‘
- [x] ç›´æ¥å‘½ä»¤è§¦å‘

### 4. é…ç½®å’Œæ–‡æ¡£
- [x] é…ç½®ç¤ºä¾‹æ–‡ä»¶
- [x] README.md
- [x] EXAMPLES.mdï¼ˆä½¿ç”¨ç¤ºä¾‹ï¼‰
- [x] IFLOW_INTEGRATION.mdï¼ˆiFlow é›†æˆæŒ‡å—ï¼‰
- [x] design.mdï¼ˆè®¾è®¡æ–‡æ¡£ï¼‰
- [x] å¿«é€Ÿå¯åŠ¨è„šæœ¬

### 5. æµ‹è¯•
- [x] ç«¯åˆ°ç«¯æµ‹è¯•è„šæœ¬
- [x] CLI å‘½ä»¤æµ‹è¯•
- [x] Daemon æµ‹è¯•

---

## ğŸ”§ ä½¿ç”¨æ–¹å¼

### æ–¹å¼ 1ï¼šCLI å‘½ä»¤

```bash
# å‘é€æ¶ˆæ¯
python3 -m src.cli.main send "ä½ å¥½"

# è¯»å–æ¶ˆæ¯
python3 -m src.cli.main read --unread

# æŸ¥çœ‹çŠ¶æ€
python3 -m src.cli.main status
```

### æ–¹å¼ 2ï¼šWatch Daemon

```bash
# å¯åŠ¨ Daemon
python3 -m src.daemon.main --foreground --client-id cli_alice
```

### æ–¹å¼ 3ï¼šMCP Server

```bash
# å¯åŠ¨ MCP Server
python3 -m src.mcp_server.server
```

### æ–¹å¼ 4ï¼šAI CLI Hooks

**Claude Code:**
```bash
cp config/hooks/check-messages.toml ~/.claude-code/hooks/
```

**iFlow CLI:**
```bash
# å¤åˆ¶é…ç½®åˆ° ~/.iflow/settings.json
cp config/iflow-settings.json ~/.iflow/settings.json
```

---

## ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

### 1. äº‹ä»¶é©±åŠ¨æ¶æ„
- Watch Daemon ç›‘å¬æ•°æ®åº“å˜åŒ–
- iFlow Notification Hook ç›‘å¬é€šçŸ¥
- æ— éœ€è½®è¯¢ï¼Œèµ„æºæ•ˆç‡é«˜

### 2. å¤š AI CLI æ”¯æŒ
- ç»Ÿä¸€çš„ç•™è¨€ç°¿åç«¯
- å„ AI CLI é€šè¿‡ Hooks é›†æˆ
- æ”¯æŒè·¨ CLI é€šä¿¡

### 3. çµæ´»çš„è§¦å‘ç­–ç•¥
- tmux æ³¨å…¥ï¼ˆé€‚åˆç»ˆç«¯ç”¨æˆ·ï¼‰
- Hook è„šæœ¬ï¼ˆé€‚åˆè‡ªåŠ¨åŒ–ï¼‰
- ç›´æ¥å‘½ä»¤ï¼ˆé€‚åˆç®€å•åœºæ™¯ï¼‰

### 4. æ•°æ®æŒä¹…åŒ–
- SQLite WAL æ¨¡å¼
- æ”¯æŒå¹¶å‘è¯»å†™
- å•æ–‡ä»¶ï¼Œæ˜“å¤‡ä»½

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# 1. å®‰è£…ä¾èµ–
cd message-board-system
pip install -r requirements.txt

# 2. åˆå§‹åŒ–
bash start.sh

# 3. å‘é€æ¶ˆæ¯
python3 -m src.cli.main send "ä½ å¥½ï¼Œè¿™æ˜¯æµ‹è¯•æ¶ˆæ¯"

# 4. å¯åŠ¨ Daemon
python3 -m src.daemon.main --foreground --client-id cli_alice
```

---

## ğŸ“Š æµ‹è¯•ç»“æœ

| æµ‹è¯•é¡¹ | çŠ¶æ€ | å¤‡æ³¨ |
|--------|------|------|
| æ•°æ®åº“åˆå§‹åŒ– | âœ… é€šè¿‡ | WAL æ¨¡å¼æ­£å¸¸ |
| CLI å‘é€æ¶ˆæ¯ | âœ… é€šè¿‡ | æ”¯æŒä¼˜å…ˆçº§ã€å›å¤ |
| CLI è¯»å–æ¶ˆæ¯ | âœ… é€šè¿‡ | æ”¯æŒ JSON è¾“å‡º |
| CLI æ ‡è®°å·²è¯» | âœ… é€šè¿‡ | å•æ¡/æ‰¹é‡ |
| Watch Daemon | âœ… é€šè¿‡ | æ–‡ä»¶ç›‘å¬æ­£å¸¸ |
| iFlow Hook | âœ… é€šè¿‡ | é€šçŸ¥è§¦å‘æ­£å¸¸ |
| ç«¯åˆ°ç«¯æµ‹è¯• | âœ… é€šè¿‡ | å¤šå®¢æˆ·ç«¯é€šä¿¡ |

---

## ğŸ”® æ‰©å±•å»ºè®®

### çŸ­æœŸ
- [ ] æ¶ˆæ¯åŠ å¯†å­˜å‚¨
- [ ] Web ç•Œé¢æŸ¥çœ‹
- [ ] æ¶ˆæ¯æœç´¢åŠŸèƒ½
- [ ] æ›´å¤š AI CLI é›†æˆï¼ˆCursorã€Windsurf ç­‰ï¼‰

### ä¸­æœŸ
- [ ] Redis åç«¯ï¼ˆé«˜å¹¶å‘åœºæ™¯ï¼‰
- [ ] æ¶ˆæ¯åˆ†ç±»/æ ‡ç­¾
- [ ] Webhook é€šçŸ¥
- [ ] å¤šç•™è¨€ç°¿æ”¯æŒ

### é•¿æœŸ
- [ ] åˆ†å¸ƒå¼æ¶æ„
- [ ] æ¶ˆæ¯é˜Ÿåˆ—é›†æˆ
- [ ] AI è‡ªåŠ¨å›å¤ä¼˜åŒ–
- [ ] æ’ä»¶ç³»ç»Ÿ

---

## ğŸ“ é…ç½®æ–‡ä»¶ç¤ºä¾‹

### ~/.message_board/config.yaml

```yaml
client:
  id: "cli_alice"
  name: "Alice CLI"

database:
  path: "~/.message_board/board.db"
  wal_mode: true

daemon:
  enabled: true
  poll_interval: 2

trigger:
  method: "tmux"
  tmux:
    session: "ai-session"
    pane: "0"
    command: "claude --prompt 'ä½ æœ‰æ–°æ¶ˆæ¯ï¼š{content}'"
```

### ~/.iflow/settings.json

```json
{
  "hooks": {
    "Notification": [
      {
        "matcher": ".*",
        "hooks": [
          {
            "type": "command",
            "command": "python3 ~/.message_board/hooks/iflow_trigger.py",
            "timeout": 60
          }
        ]
      }
    ]
  },
  "env": {
    "MESSAGE_CLIENT_ID": "iflow_cli",
    "USE_LLM": "false"
  }
}
```

---

## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®å®ç°äº†ï¼š
1. **è·¨ç»ˆç«¯ AI CLI é€šä¿¡** - è§£å†³äº† AI CLI ä¼šè¯éš”ç¦»é—®é¢˜
2. **äº‹ä»¶é©±åŠ¨è‡ªåŠ¨å›å¤** - åˆ©ç”¨ Hooks å®ç°æ™ºèƒ½è§¦å‘
3. **å¤š AI CLI æ”¯æŒ** - ç»Ÿä¸€çš„ç•™è¨€ç°¿åç«¯
4. **å®Œæ•´çš„æ–‡æ¡£å’Œæµ‹è¯•** - æ˜“äºä½¿ç”¨å’Œæ‰©å±•

---

## ğŸ“§ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·å‚è€ƒï¼š
- [README.md](README.md) - é¡¹ç›®è¯´æ˜
- [EXAMPLES.md](EXAMPLES.md) - ä½¿ç”¨ç¤ºä¾‹
- [IFLOW_INTEGRATION.md](IFLOW_INTEGRATION.md) - iFlow é›†æˆæŒ‡å—
- [design.md](design.md) - è®¾è®¡æ–‡æ¡£
