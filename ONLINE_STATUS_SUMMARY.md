# åœ¨çº¿çŠ¶æ€ç›‘æ§ - å®Œæˆæ€»ç»“ âœ…

**åˆ›å»ºæ—¶é—´**: 2026-02-27 09:45  
**æ–‡ä»¶**: `online_status.py`

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### å®æ—¶æ˜¾ç¤ºåœ¨çº¿çŠ¶æ€

```
============================================================
ğŸ“Š åœ¨çº¿çŠ¶æ€ç›‘æ§
============================================================
æ€»å®¢æˆ·ç«¯ï¼š5
ğŸŸ¢ åœ¨çº¿ï¼š2
ğŸ‘‚ ç›‘å¬ä¸­ï¼š2
ğŸ”´ ç¦»çº¿ï¼š1
============================================================

ğŸ‘‚ ç›‘å¬ä¸­:
   â€¢ ai_a
   â€¢ ai_b

ğŸŸ¢ åœ¨çº¿ï¼ˆæœªç›‘å¬ï¼‰:
   â€¢ user_c

ğŸ”´ ç¦»çº¿:
   â€¢ user_d
============================================================
```

---

## ğŸ“ æ–°å¢æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `online_status.py` | åœ¨çº¿çŠ¶æ€ç›‘æ§ä¸»ç¨‹åº |
| `ONLINE_STATUS_GUIDE.md` | ä½¿ç”¨æŒ‡å— |

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### 1. å®¢æˆ·ç«¯æ³¨å†Œ

```bash
python3 online_status.py register my_ai
```

### 2. çŠ¶æ€ç®¡ç†

```bash
# è®¾ç½®ç›‘å¬çŠ¶æ€
python3 online_status.py listening my_ai

# è®¾ç½®ç¦»çº¿çŠ¶æ€
python3 online_status.py offline my_ai

# å‘é€å¿ƒè·³
python3 online_status.py heartbeat my_ai
```

### 3. å®æ—¶ç›‘æ§

```bash
# æŒç»­ç›‘æ§ï¼ˆæ¯ 10 ç§’åˆ·æ–°ï¼‰
python3 online_status.py monitor --interval 10
```

### 4. è‡ªåŠ¨é›†æˆ

AI å¯¹è¯ç›‘å¬å™¨å¯åŠ¨æ—¶è‡ªåŠ¨ï¼š
- æ³¨å†Œå®¢æˆ·ç«¯
- è®¾ç½®ä¸ºç›‘å¬çŠ¶æ€
- æ¯ 30 ç§’å‘é€å¿ƒè·³
- åœæ­¢æ—¶è®¾ç½®ç¦»çº¿

---

## ğŸš€ ä½¿ç”¨æ–¹å¼

### å‘½ä»¤è¡Œ

```bash
# æ˜¾ç¤ºçŠ¶æ€
python3 online_status.py show

# æ³¨å†Œ
python3 online_status.py register my_ai

# è®¾ç½®ç›‘å¬
python3 online_status.py listening my_ai

# ç›‘æ§
python3 online_status.py monitor
```

### Python ä»£ç 

```python
from online_status import OnlineStatusMonitor

monitor = OnlineStatusMonitor()

# æ³¨å†Œ
monitor.register_client("my_ai", "listening")

# æ˜¾ç¤ºçŠ¶æ€
print(monitor.get_status_display())

# å‘é€å¿ƒè·³
monitor.heartbeat("my_ai")
```

### AI å¯¹è¯è‡ªåŠ¨é›†æˆ

```python
from ai_conversation import AIConversation

# è‡ªåŠ¨æ³¨å†Œå¹¶æ˜¾ç¤ºçŠ¶æ€
conv = AIConversation("my_ai", "partner_ai")
conv.conversation_loop("ä½ å¥½")

# è¾“å‡º:
# âœ… my_ai å·²æ³¨å†Œï¼ŒçŠ¶æ€ï¼šlistening
# ğŸ“Š å½“å‰åœ¨çº¿çŠ¶æ€:
# ...
```

---

## ğŸ“Š çŠ¶æ€è¯´æ˜

| çŠ¶æ€ | å›¾æ ‡ | è¯´æ˜ | è¶…æ—¶ |
|------|------|------|------|
| **ç›‘å¬ä¸­** | ğŸ‘‚ | æ­£åœ¨ç›‘å¬ç•™è¨€ç°¿ | - |
| **åœ¨çº¿** | ğŸŸ¢ | å·²æ³¨å†Œä½†æœªç›‘å¬ | 2 åˆ†é’Ÿ |
| **ç¦»çº¿** | ğŸ”´ | è¶…æ—¶æˆ–æ‰‹åŠ¨è®¾ç½® | - |

---

## ğŸ¯ å®Œæ•´å·¥ä½œæµç¨‹

```
AI å¯åŠ¨
    â†“
æ³¨å†Œå®¢æˆ·ç«¯ (listening)
    â†“
æ˜¾ç¤ºåœ¨çº¿çŠ¶æ€
    â†“
å¼€å§‹å¯¹è¯
    â†“
æ¯ 30 ç§’å‘é€å¿ƒè·³
    â†“
ç»§ç»­å¯¹è¯...
    â†“
åœæ­¢æ—¶è®¾ç½®ç¦»çº¿
```

---

## ğŸ’¡ å®é™…åº”ç”¨åœºæ™¯

### åœºæ™¯ 1: æŸ¥çœ‹è°åœ¨çº¿

```bash
python3 online_status.py show
```

**è¾“å‡º**:
```
============================================================
ğŸ“Š åœ¨çº¿çŠ¶æ€ç›‘æ§
============================================================
æ€»å®¢æˆ·ç«¯ï¼š5
ğŸŸ¢ åœ¨çº¿ï¼š2
ğŸ‘‚ ç›‘å¬ä¸­ï¼š2
ğŸ”´ ç¦»çº¿ï¼š1
============================================================

ğŸ‘‚ ç›‘å¬ä¸­:
   â€¢ ai_a
   â€¢ ai_b

ğŸŸ¢ åœ¨çº¿ï¼ˆæœªç›‘å¬ï¼‰:
   â€¢ user_c
   â€¢ user_d

ğŸ”´ ç¦»çº¿:
   â€¢ user_e
============================================================
```

### åœºæ™¯ 2: ç›‘æ§æ‰€æœ‰å®¢æˆ·ç«¯

```bash
python3 online_status.py monitor --interval 5
```

### åœºæ™¯ 3: AI è‡ªåŠ¨ç®¡ç†çŠ¶æ€

```python
from ai_conversation import AIConversation

conv = AIConversation("ai_a", "ai_b")

# å¯åŠ¨æ—¶è‡ªåŠ¨ï¼š
# 1. æ³¨å†Œä¸º listening
# 2. æ˜¾ç¤ºåœ¨çº¿çŠ¶æ€
# 3. æ¯ 30 ç§’å¿ƒè·³
# 4. åœæ­¢æ—¶ç¦»çº¿

conv.conversation_loop("ä½ å¥½")
```

---

## âš™ï¸ é…ç½®é€‰é¡¹

### å¿ƒè·³é—´éš”

```python
monitor.heartbeat_interval = 30  # 30 ç§’
```

### è¶…æ—¶é˜ˆå€¼

```python
monitor.timeout_threshold = 120  # 2 åˆ†é’Ÿ
```

### ç›‘æ§åˆ·æ–°é—´éš”

```bash
python3 online_status.py monitor --interval 10  # 10 ç§’
```

---

## ğŸ“ çŠ¶æ€æ–‡ä»¶

**ä½ç½®**: `~/.message_board/online_status.json`

**æ ¼å¼**:
```json
{
  "clients": {
    "ai_a": {
      "status": "listening",
      "last_seen": 1234567890,
      "message_count": 10
    }
  },
  "last_update": 1234567890
}
```

---

## âœ… æµ‹è¯•ç»“æœ

```bash
# æµ‹è¯•æ³¨å†Œ
âœ… test_ai_a å·²æ³¨å†Œï¼ŒçŠ¶æ€ï¼šonline

# æµ‹è¯•æ˜¾ç¤º
============================================================
ğŸ“Š åœ¨çº¿çŠ¶æ€ç›‘æ§
============================================================
æ€»å®¢æˆ·ç«¯ï¼š1
ğŸŸ¢ åœ¨çº¿ï¼š1
ğŸ‘‚ ç›‘å¬ä¸­ï¼š0
ğŸ”´ ç¦»çº¿ï¼š0
============================================================

ğŸŸ¢ åœ¨çº¿ï¼ˆæœªç›‘å¬ï¼‰:
   â€¢ test_ai_a
============================================================
```

**çŠ¶æ€**: âœ… æ­£å¸¸å·¥ä½œ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [ONLINE_STATUS_GUIDE.md](ONLINE_STATUS_GUIDE.md) | å®Œæ•´ä½¿ç”¨æŒ‡å— |
| [AI_CONVERSATION_GUIDE.md](AI_CONVERSATION_GUIDE.md) | AI å¯¹è¯ç›‘å¬å™¨ |
| [REALTIME_LISTENER_GUIDE.md](REALTIME_LISTENER_GUIDE.md) | å®æ—¶ç›‘å¬å™¨ |

---

**ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2026-02-27
